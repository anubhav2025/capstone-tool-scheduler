[{"number":13,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"socket.io"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-25hc-qcg6-38wj","cve_id":"CVE-2024-38355","summary":"socket.io has an unhandled 'error' event","description":"### Impact\n\nA specially crafted Socket.IO packet can trigger an uncaught exception on the Socket.IO server, thus killing the Node.js process.\n\n```\nnode:events:502\n    throw err; // Unhandled 'error' event\n    ^\n\nError [ERR_UNHANDLED_ERROR]: Unhandled error. (undefined)\n    at new NodeError (node:internal/errors:405:5)\n    at Socket.emit (node:events:500:17)\n    at /myapp/node_modules/socket.io/lib/socket.js:531:14\n    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {\n  code: 'ERR_UNHANDLED_ERROR',\n  context: undefined\n}\n```\n\n### Affected versions\n\n| Version range    | Needs minor update?                            |\n|------------------|------------------------------------------------|\n| `4.6.2...latest` | Nothing to do               |\n| `3.0.0...4.6.1`  | Please upgrade to `socket.io@4.6.2` (at least) |\n| `2.3.0...2.5.0`  | Please upgrade to `socket.io@2.5.1`            |\n\n### Patches\n\nThis issue is fixed by https://github.com/socketio/socket.io/commit/15af22fc22bc6030fcead322c106f07640336115, included in `socket.io@4.6.2` (released in May 2023).\n\nThe fix was backported in the 2.x branch today: https://github.com/socketio/socket.io/commit/d30630ba10562bf987f4d2b42440fc41a828119c\n\n### Workarounds\n\nAs a workaround for the affected versions of the `socket.io` package, you can attach a listener for the \"error\" event:\n\n```js\nio.on(\"connection\", (socket) => {\n  socket.on(\"error\", () => {\n    // ...\n  });\n});\n```\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n\n- Open a discussion [here](https://github.com/socketio/socket.io/discussions)\n\nThanks a lot to [Paul Taylor](https://github.com/Y0ursTruly) for the responsible disclosure.\n\n### References\n\n- https://github.com/socketio/socket.io/commit/15af22fc22bc6030fcead322c106f07640336115\n- https://github.com/socketio/socket.io/commit/d30630ba10562bf987f4d2b42440fc41a828119c\n","severity":"medium","identifiers":[{"value":"GHSA-25hc-qcg6-38wj","type":"GHSA"},{"value":"CVE-2024-38355","type":"CVE"}],"references":[{"url":"https://github.com/socketio/socket.io/security/advisories/GHSA-25hc-qcg6-38wj"},{"url":"https://github.com/socketio/socket.io/commit/15af22fc22bc6030fcead322c106f07640336115"},{"url":"https://github.com/socketio/socket.io/commit/d30630ba10562bf987f4d2b42440fc41a828119c"},{"url":"https://nvd.nist.gov/vuln/detail/CVE-2024-38355"},{"url":"https://github.com/advisories/GHSA-25hc-qcg6-38wj"}],"published_at":"2024-06-19T15:04:41Z","updated_at":"2024-11-18T16:26:46Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"socket.io"},"severity":"medium","vulnerable_version_range":"< 2.5.0","first_patched_version":{"identifier":"2.5.1"}},{"package":{"ecosystem":"npm","name":"socket.io"},"severity":"medium","vulnerable_version_range":">= 3.0.0, < 4.6.2","first_patched_version":{"identifier":"4.6.2"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L","score":7.3},"cvss_v4":{"vector_string":"CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N","score":6.9}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L","score":7.3},"cwes":[{"cwe_id":"CWE-20","name":"Improper Input Validation"},{"cwe_id":"CWE-754","name":"Improper Check for Unusual or Exceptional Conditions"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"socket.io"},"severity":"medium","vulnerable_version_range":">= 3.0.0, < 4.6.2","first_patched_version":{"identifier":"4.6.2"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/13","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/13","created_at":"2025-01-27T04:39:25Z","updated_at":"2025-01-27T04:39:25Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":12,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"sanitize-html"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-cgfm-xwp7-2cvr","cve_id":"CVE-2022-25887","summary":"Sanitize-html Vulnerable To REDoS Attacks","description":"The package sanitize-html before 2.7.1 are vulnerable to Regular Expression Denial of Service (ReDoS) due to insecure global regular expression replacement logic of HTML comment removal.","severity":"high","identifiers":[{"value":"GHSA-cgfm-xwp7-2cvr","type":"GHSA"},{"value":"CVE-2022-25887","type":"CVE"}],"references":[{"url":"https://nvd.nist.gov/vuln/detail/CVE-2022-25887"},{"url":"https://github.com/apostrophecms/sanitize-html/pull/557"},{"url":"https://github.com/apostrophecms/sanitize-html/commit/b4682c12fd30e12e82fa2d9b766de91d7d2cd23c"},{"url":"https://security.snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-3008102"},{"url":"https://security.snyk.io/vuln/SNYK-JS-SANITIZEHTML-2957526"},{"url":"https://github.com/advisories/GHSA-cgfm-xwp7-2cvr"}],"published_at":"2022-08-31T00:00:24Z","updated_at":"2024-04-22T23:16:47Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"high","vulnerable_version_range":"< 2.7.1","first_patched_version":{"identifier":"2.7.1"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H","score":7.5},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H","score":7.5},"cwes":[{"cwe_id":"CWE-1333","name":"Inefficient Regular Expression Complexity"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"high","vulnerable_version_range":"< 2.7.1","first_patched_version":{"identifier":"2.7.1"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/12","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/12","created_at":"2025-01-27T04:39:25Z","updated_at":"2025-01-27T04:39:25Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":11,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"sanitize-html"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-rm97-x556-q36h","cve_id":"CVE-2024-21501","summary":"sanitize-html Information Exposure vulnerability","description":"Versions of the package sanitize-html before 2.12.1 are vulnerable to Information Exposure when used on the backend and with the style attribute allowed, allowing enumeration of files in the system (including project dependencies). An attacker could exploit this vulnerability to gather details about the file system structure and dependencies of the targeted server.","severity":"medium","identifiers":[{"value":"GHSA-rm97-x556-q36h","type":"GHSA"},{"value":"CVE-2024-21501","type":"CVE"}],"references":[{"url":"https://nvd.nist.gov/vuln/detail/CVE-2024-21501"},{"url":"https://github.com/apostrophecms/sanitize-html/pull/650"},{"url":"https://github.com/apostrophecms/sanitize-html/commit/c5dbdf77fe8b836d3bf4554ea39edb45281ec0b4"},{"url":"https://gist.github.com/Slonser/8b4d061abe6ee1b2e10c7242987674cf"},{"url":"https://github.com/apostrophecms/apostrophe/discussions/4436"},{"url":"https://security.snyk.io/vuln/SNYK-JS-SANITIZEHTML-6256334"},{"url":"https://security.snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-6276557"},{"url":"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4EB5JPYRCTS64EA5AMV3INHDPI6I4AW7"},{"url":"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/P4I5X6V3LYUNBMZ5YOW4BV427TH3IK4S"},{"url":"https://github.com/advisories/GHSA-rm97-x556-q36h"}],"published_at":"2024-02-24T06:30:17Z","updated_at":"2024-08-28T21:58:19Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"< 2.12.1","first_patched_version":{"identifier":"2.12.1"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N","score":5.3},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N","score":5.3},"cwes":[{"cwe_id":"CWE-200","name":"Exposure of Sensitive Information to an Unauthorized Actor"},{"cwe_id":"CWE-538","name":"Insertion of Sensitive Information into Externally-Accessible File or Directory"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"< 2.12.1","first_patched_version":{"identifier":"2.12.1"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/11","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/11","created_at":"2025-01-27T04:39:25Z","updated_at":"2025-01-27T04:39:25Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":10,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-qwph-4952-7xr6","cve_id":"CVE-2022-23540","summary":"jsonwebtoken vulnerable to signature validation bypass due to insecure default algorithm in jwt.verify()","description":"# Overview\n\nIn versions <=8.5.1 of jsonwebtoken library, lack of algorithm definition and a falsy secret or key in the `jwt.verify()` function can lead to signature validation bypass due to defaulting to the `none` algorithm for signature verification.\n\n# Am I affected?\nYou will be affected if all the following are true in the `jwt.verify()` function:\n- a token with no signature is received\n- no algorithms are specified \n- a falsy (e.g. null, false, undefined) secret or key is passed \n\n# How do I fix it?\n \nUpdate to version 9.0.0 which removes the default support for the none algorithm in the `jwt.verify()` method. \n\n# Will the fix impact my users?\n\nThere will be no impact, if you update to version 9.0.0 and you don’t need to allow for the `none` algorithm. If you need 'none' algorithm, you have to explicitly specify that in `jwt.verify()` options.\n","severity":"medium","identifiers":[{"value":"GHSA-qwph-4952-7xr6","type":"GHSA"},{"value":"CVE-2022-23540","type":"CVE"}],"references":[{"url":"https://github.com/auth0/node-jsonwebtoken/security/advisories/GHSA-qwph-4952-7xr6"},{"url":"https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3"},{"url":"https://nvd.nist.gov/vuln/detail/CVE-2022-23540"},{"url":"https://security.netapp.com/advisory/ntap-20240621-0007"},{"url":"https://github.com/advisories/GHSA-qwph-4952-7xr6"}],"published_at":"2022-12-22T03:32:59Z","updated_at":"2024-06-21T21:34:57Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"severity":"medium","vulnerable_version_range":"< 9.0.0","first_patched_version":{"identifier":"9.0.0"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:L","score":6.4},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:L","score":6.4},"cwes":[{"cwe_id":"CWE-287","name":"Improper Authentication"},{"cwe_id":"CWE-327","name":"Use of a Broken or Risky Cryptographic Algorithm"},{"cwe_id":"CWE-347","name":"Improper Verification of Cryptographic Signature"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"severity":"medium","vulnerable_version_range":"< 9.0.0","first_patched_version":{"identifier":"9.0.0"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/10","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/10","created_at":"2025-01-27T04:39:25Z","updated_at":"2025-01-27T04:39:25Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":9,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-hjrf-2m68-5959","cve_id":"CVE-2022-23541","summary":"jsonwebtoken's insecure implementation of key retrieval function could lead to Forgeable Public/Private Tokens from RSA to HMAC","description":"# Overview\n\nVersions `<=8.5.1` of `jsonwebtoken` library can be misconfigured so that passing a poorly implemented key retrieval function (referring to the `secretOrPublicKey` argument from the [readme link](https://github.com/auth0/node-jsonwebtoken#jwtverifytoken-secretorpublickey-options-callback)) will result in incorrect verification of tokens. There is a possibility of using a different algorithm and key combination in verification  than the one that was used to sign the tokens. Specifically, tokens signed with an asymmetric public key could be verified with a symmetric HS256 algorithm. This can lead to successful validation of forged tokens. \n\n# Am I affected?\n\nYou will be affected if your application is supporting usage of both symmetric key and asymmetric key in jwt.verify() implementation with the same key retrieval function. \n\n# How do I fix it?\n \nUpdate to version 9.0.0.\n\n# Will the fix impact my users?\n\nThere is no impact for end users","severity":"medium","identifiers":[{"value":"GHSA-hjrf-2m68-5959","type":"GHSA"},{"value":"CVE-2022-23541","type":"CVE"}],"references":[{"url":"https://github.com/auth0/node-jsonwebtoken/security/advisories/GHSA-hjrf-2m68-5959"},{"url":"https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3"},{"url":"https://nvd.nist.gov/vuln/detail/CVE-2022-23541"},{"url":"https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0"},{"url":"https://security.netapp.com/advisory/ntap-20240621-0007"},{"url":"https://github.com/advisories/GHSA-hjrf-2m68-5959"}],"published_at":"2022-12-22T03:33:19Z","updated_at":"2024-06-24T21:24:07Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"severity":"medium","vulnerable_version_range":"<= 8.5.1","first_patched_version":{"identifier":"9.0.0"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L","score":5.0},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L","score":5.0},"cwes":[{"cwe_id":"CWE-287","name":"Improper Authentication"},{"cwe_id":"CWE-1259","name":"Improper Restriction of Security Token Assignment"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"severity":"medium","vulnerable_version_range":"<= 8.5.1","first_patched_version":{"identifier":"9.0.0"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/9","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/9","created_at":"2025-01-27T04:39:25Z","updated_at":"2025-01-27T04:39:25Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":8,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-8cf7-32gw-wr33","cve_id":"CVE-2022-23539","summary":"jsonwebtoken unrestricted key type could lead to legacy keys usage ","description":"# Overview\n\nVersions `<=8.5.1` of `jsonwebtoken` library could be misconfigured so that legacy, insecure key types are used for signature verification. For example, DSA keys could be used with the RS256 algorithm. \n\n# Am I affected?\n\nYou are affected if you are using an algorithm and a key type other than the combinations mentioned below\n\n| Key type |  algorithm                                    |\n|----------|------------------------------------------|\n| ec           | ES256, ES384, ES512                      |\n| rsa          | RS256, RS384, RS512, PS256, PS384, PS512 |\n| rsa-pss  | PS256, PS384, PS512                      |\n\nAnd for Elliptic Curve algorithms:\n\n| `alg` | Curve      |\n|-------|------------|\n| ES256 | prime256v1 |\n| ES384 | secp384r1  |\n| ES512 | secp521r1  |\n\n# How do I fix it?\n\nUpdate to version 9.0.0. This version validates for asymmetric key type and algorithm combinations. Please refer to the above mentioned algorithm / key type combinations for the valid secure configuration. After updating to version 9.0.0, If you still intend to continue with signing or verifying tokens using invalid key type/algorithm value combinations, you’ll need to set the `allowInvalidAsymmetricKeyTypes` option to `true` in the `sign()` and/or `verify()` functions.\n\n# Will the fix impact my users?\n\nThere will be no impact, if you update to version 9.0.0 and you already use a valid secure combination of key type and algorithm. Otherwise,  use the  `allowInvalidAsymmetricKeyTypes` option  to `true` in the `sign()` and `verify()` functions to continue usage of invalid key type/algorithm combination in 9.0.0 for legacy compatibility. \n\n","severity":"high","identifiers":[{"value":"GHSA-8cf7-32gw-wr33","type":"GHSA"},{"value":"CVE-2022-23539","type":"CVE"}],"references":[{"url":"https://github.com/auth0/node-jsonwebtoken/security/advisories/GHSA-8cf7-32gw-wr33"},{"url":"https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3"},{"url":"https://nvd.nist.gov/vuln/detail/CVE-2022-23539"},{"url":"https://security.netapp.com/advisory/ntap-20240621-0007"},{"url":"https://github.com/advisories/GHSA-8cf7-32gw-wr33"}],"published_at":"2022-12-22T03:32:22Z","updated_at":"2024-06-24T21:23:39Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"severity":"high","vulnerable_version_range":"<= 8.5.1","first_patched_version":{"identifier":"9.0.0"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N","score":8.1},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N","score":8.1},"cwes":[{"cwe_id":"CWE-327","name":"Use of a Broken or Risky Cryptographic Algorithm"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"severity":"high","vulnerable_version_range":"<= 8.5.1","first_patched_version":{"identifier":"9.0.0"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/8","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/8","created_at":"2025-01-27T04:39:25Z","updated_at":"2025-01-27T04:39:25Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":7,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"sanitize-html"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-rjqq-98f6-6j3r","cve_id":"CVE-2021-26539","summary":"Improper Input Validation in sanitize-html","description":"Apostrophe Technologies sanitize-html before 2.3.1 does not properly handle internationalized domain name (IDN) which could allow an attacker to bypass hostname whitelist validation set by the \"allowedIframeHostnames\" option.","severity":"medium","identifiers":[{"value":"GHSA-rjqq-98f6-6j3r","type":"GHSA"},{"value":"CVE-2021-26539","type":"CVE"}],"references":[{"url":"https://nvd.nist.gov/vuln/detail/CVE-2021-26539"},{"url":"https://github.com/apostrophecms/sanitize-html/pull/458"},{"url":"https://advisory.checkmarx.net/advisory/CX-2021-4308"},{"url":"https://github.com/apostrophecms/sanitize-html/blob/main/CHANGELOG.md#231-2021-01-22"},{"url":"https://github.com/apostrophecms/sanitize-html/commit/bdf7836ef8f0e5b21f9a1aab0623ae8fcd09c1da"},{"url":"https://github.com/advisories/GHSA-rjqq-98f6-6j3r"}],"published_at":"2021-05-06T16:10:05Z","updated_at":"2023-04-21T19:19:09Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"< 2.3.1","first_patched_version":{"identifier":"2.3.1"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N","score":5.3},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N","score":5.3},"cwes":[{"cwe_id":"CWE-20","name":"Improper Input Validation"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"< 2.3.1","first_patched_version":{"identifier":"2.3.1"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/7","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/7","created_at":"2025-01-27T04:39:25Z","updated_at":"2025-01-27T04:39:25Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":6,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"sanitize-html"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-mjxr-4v3x-q3m4","cve_id":"CVE-2021-26540","summary":"Improper Input Validation in sanitize-html","description":"Apostrophe Technologies sanitize-html before 2.3.2 does not properly validate the hostnames set by the \"allowedIframeHostnames\" option when the \"allowIframeRelativeUrls\" is set to true, which allows attackers to bypass hostname whitelist for iframe element, related using an src value that starts with \"/\\\\example.com\".","severity":"medium","identifiers":[{"value":"GHSA-mjxr-4v3x-q3m4","type":"GHSA"},{"value":"CVE-2021-26540","type":"CVE"}],"references":[{"url":"https://nvd.nist.gov/vuln/detail/CVE-2021-26540"},{"url":"https://github.com/apostrophecms/sanitize-html/pull/460"},{"url":"https://advisory.checkmarx.net/advisory/CX-2021-4309"},{"url":"https://github.com/apostrophecms/sanitize-html/blob/main/CHANGELOG.md#232-2021-01-26"},{"url":"https://github.com/advisories/GHSA-mjxr-4v3x-q3m4"}],"published_at":"2021-05-06T16:10:19Z","updated_at":"2023-02-01T05:05:21Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"< 2.3.2","first_patched_version":{"identifier":"2.3.2"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N","score":5.3},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N","score":5.3},"cwes":[{"cwe_id":"CWE-20","name":"Improper Input Validation"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"< 2.3.2","first_patched_version":{"identifier":"2.3.2"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/6","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/6","created_at":"2025-01-27T04:39:25Z","updated_at":"2025-01-27T04:39:25Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":5,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"marsdb"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-5mrr-rgp6-x4gr","cve_id":null,"summary":"Command Injection in marsdb","description":"All versions of `marsdb` are vulnerable to Command Injection. In the `DocumentMatcher` class, selectors on `$where` clauses are passed to a Function constructor unsanitized. This allows attackers to run arbitrary commands in the system when the function is executed.\n\n\n## Recommendation\n\nNo fix is currently available. Consider using an alternative package until a fix is made available.","severity":"critical","identifiers":[{"value":"GHSA-5mrr-rgp6-x4gr","type":"GHSA"}],"references":[{"url":"https://github.com/bkimminich/juice-shop/issues/1173"},{"url":"https://www.npmjs.com/advisories/1122"},{"url":"https://github.com/advisories/GHSA-5mrr-rgp6-x4gr"}],"published_at":"2020-09-03T19:39:05Z","updated_at":"2023-01-09T05:03:48Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"marsdb"},"severity":"critical","vulnerable_version_range":">= 0.0.0","first_patched_version":null}],"cvss_severities":{"cvss_v3":{"vector_string":null,"score":0.0},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":null,"score":0.0},"cwes":[{"cwe_id":"CWE-77","name":"Improper Neutralization of Special Elements used in a Command ('Command Injection')"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"marsdb"},"severity":"critical","vulnerable_version_range":">= 0.0.0","first_patched_version":null},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/5","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/5","created_at":"2025-01-27T04:39:24Z","updated_at":"2025-01-27T04:39:24Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":4,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"express-jwt"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-6g6m-m6h5-w9gf","cve_id":"CVE-2020-15084","summary":"Authorization bypass in express-jwt","description":"### Overview\nVersions before and including 5.3.3, we are not enforcing the **algorithms** entry to be specified in the configuration.\nWhen **algorithms** is not specified in the configuration, with the combination of jwks-rsa, it may lead to authorization bypass. \n\n### Am I affected?\nYou are affected by this vulnerability if all of the following conditions apply:\n\nYou are using express-jwt\nAND \nYou do not have **algorithms**  configured in your express-jwt configuration.\nAND\nYou are using libraries such as jwks-rsa as the **secret**. \n\n### How to fix that?\nSpecify **algorithms** in the express-jwt configuration. The following is an example of a proper configuration\n\n``` \nconst checkJwt = jwt({\n  secret: jwksRsa.expressJwtSecret({\n    rateLimit: true,\n    jwksRequestsPerMinute: 5,\n    jwksUri: `https://${DOMAIN}/.well-known/jwks.json`\n  }),\n  // Validate the audience and the issuer.\n  audience: process.env.AUDIENCE,\n  issuer: `https://${DOMAIN}/`,\n  // restrict allowed algorithms\n  algorithms: ['RS256']\n}); \n```\n\n### Will this update impact my users?\nThe fix provided in patch will not affect your users if you specified the algorithms allowed. The patch now makes **algorithms** a required configuration. \n\n\n### Credit\nIST Group","severity":"high","identifiers":[{"value":"GHSA-6g6m-m6h5-w9gf","type":"GHSA"},{"value":"CVE-2020-15084","type":"CVE"}],"references":[{"url":"https://github.com/auth0/express-jwt/security/advisories/GHSA-6g6m-m6h5-w9gf"},{"url":"https://github.com/auth0/express-jwt/commit/7ecab5f8f0cab5297c2b863596566eb0c019cdef"},{"url":"https://nvd.nist.gov/vuln/detail/CVE-2020-15084"},{"url":"https://github.com/advisories/GHSA-6g6m-m6h5-w9gf"}],"published_at":"2020-06-30T16:05:24Z","updated_at":"2023-02-02T05:04:02Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"express-jwt"},"severity":"high","vulnerable_version_range":"<= 5.3.3","first_patched_version":{"identifier":"6.0.0"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N","score":7.7},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N","score":7.7},"cwes":[{"cwe_id":"CWE-285","name":"Improper Authorization"},{"cwe_id":"CWE-863","name":"Incorrect Authorization"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"express-jwt"},"severity":"high","vulnerable_version_range":"<= 5.3.3","first_patched_version":{"identifier":"6.0.0"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/4","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/4","created_at":"2025-01-27T04:39:24Z","updated_at":"2025-01-27T04:39:24Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":3,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"sanitize-html"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-3j7m-hmh3-9jmp","cve_id":"CVE-2016-1000237","summary":"Cross-Site Scripting in sanitize-html","description":"Affected versions of `sanitize-html` do not sanitize input recursively, which may allow an attacker to execute arbitrary Javascript.\n\n\n## Recommendation\n\nUpdate to version 1.4.3 or later.","severity":"medium","identifiers":[{"value":"GHSA-3j7m-hmh3-9jmp","type":"GHSA"},{"value":"CVE-2016-1000237","type":"CVE"}],"references":[{"url":"https://nvd.nist.gov/vuln/detail/CVE-2016-1000237"},{"url":"https://github.com/apostrophecms/sanitize-html/issues/29"},{"url":"https://github.com/apostrophecms/sanitize-html/commit/762fbc7bba389f3f789cc291c1eb2b64f60f2caf"},{"url":"https://raw.githubusercontent.com/distributedweaknessfiling/cvelist/master/2016/1000xxx/CVE-2016-1000237.json"},{"url":"https://github.com/punkave/sanitize-html/issues/29"},{"url":"https://www.npmjs.com/advisories/135"},{"url":"https://github.com/advisories/GHSA-3j7m-hmh3-9jmp"}],"published_at":"2020-04-16T03:14:47Z","updated_at":"2023-01-09T05:02:23Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"< 1.4.3","first_patched_version":{"identifier":"1.4.3"}}],"cvss_severities":{"cvss_v3":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N","score":6.1},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N","score":6.1},"cwes":[{"cwe_id":"CWE-79","name":"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"< 1.4.3","first_patched_version":{"identifier":"1.4.3"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/3","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/3","created_at":"2025-01-27T04:39:24Z","updated_at":"2025-01-27T04:39:24Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":2,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"sanitize-html"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-xc6g-ggrc-qq4r","cve_id":"CVE-2017-16016","summary":"Cross-Site Scripting in sanitize-html","description":"Affected versions of `sanitize-html` are vulnerable to cross-site scripting when allowedTags includes at least one `nonTextTag`.\n\n## Proof of Concept\n\n```js\nvar sanitizeHtml = require('sanitize-html');\n\nvar dirty = '!<textarea>&lt;/textarea&gt;<svg/onload=prompt`xs`&gt;</textarea>!';\nvar clean = sanitizeHtml(dirty, {\n    allowedTags: [ 'textarea' ]\n});\n\nconsole.log(clean);\n\n// !<textarea></textarea><svg/onload=prompt`xs`></textarea>!\n```\n\n\n## Recommendation\n\nUpdate to version 1.11.4 or later.","severity":"medium","identifiers":[{"value":"GHSA-xc6g-ggrc-qq4r","type":"GHSA"},{"value":"CVE-2017-16016","type":"CVE"}],"references":[{"url":"https://nvd.nist.gov/vuln/detail/CVE-2017-16016"},{"url":"https://github.com/punkave/sanitize-html/issues/100"},{"url":"https://github.com/punkave/sanitize-html/commit/5d205a1005ba0df80e21d8c64a15bb3accdb2403)))"},{"url":"https://github.com/advisories/GHSA-xc6g-ggrc-qq4r"},{"url":"https://npmjs.com/package/sanitize-html#discarding-the-entire-contents-of-a-disallowed-tag"},{"url":"https://www.npmjs.com/advisories/154"},{"url":"https://github.com/punkave/sanitize-html/commit/5d205a1005ba0df80e21d8c64a15bb3accdb2403"}],"published_at":"2018-11-09T17:47:23Z","updated_at":"2023-09-08T23:04:55Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"<= 1.11.1","first_patched_version":{"identifier":"1.11.4"}}],"cvss_severities":{"cvss_v3":{"vector_string":null,"score":0.0},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":null,"score":0.0},"cwes":[{"cwe_id":"CWE-79","name":"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"sanitize-html"},"severity":"medium","vulnerable_version_range":"<= 1.11.1","first_patched_version":{"identifier":"1.11.4"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/2","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/2","created_at":"2025-01-27T04:39:24Z","updated_at":"2025-01-27T04:39:24Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null},{"number":1,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"manifest_path":"package.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-c7hr-j4mj-j2w6","cve_id":"CVE-2015-9235","summary":"Verification Bypass in jsonwebtoken","description":"Versions 4.2.1 and earlier of `jsonwebtoken` are affected by a verification bypass vulnerability. This is a result of weak validation of the JWT algorithm type, occuring when an attacker is allowed to arbitrarily specify the JWT algorithm.\n\n\n\n\n## Recommendation\n\nUpdate to version 4.2.2 or later.","severity":"critical","identifiers":[{"value":"GHSA-c7hr-j4mj-j2w6","type":"GHSA"},{"value":"CVE-2015-9235","type":"CVE"}],"references":[{"url":"https://nvd.nist.gov/vuln/detail/CVE-2015-9235"},{"url":"https://github.com/auth0/node-jsonwebtoken/commit/1bb584bc382295eeb7ee8c4452a673a77a68b687"},{"url":"https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/"},{"url":"https://github.com/advisories/GHSA-c7hr-j4mj-j2w6"},{"url":"https://www.npmjs.com/advisories/17"},{"url":"https://www.timmclean.net/2015/02/25/jwt-alg-none.html"}],"published_at":"2018-10-09T00:38:30Z","updated_at":"2023-01-09T05:02:50Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"severity":"critical","vulnerable_version_range":"< 4.2.2","first_patched_version":{"identifier":"4.2.2"}}],"cvss_severities":{"cvss_v3":{"vector_string":null,"score":0.0},"cvss_v4":{"vector_string":null,"score":0.0}},"cvss":{"vector_string":null,"score":0.0},"cwes":[{"cwe_id":"CWE-20","name":"Improper Input Validation"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"jsonwebtoken"},"severity":"critical","vulnerable_version_range":"< 4.2.2","first_patched_version":{"identifier":"4.2.2"}},"url":"https://api.github.com/repos/anubhav2025/juice-shop/dependabot/alerts/1","html_url":"https://github.com/anubhav2025/juice-shop/security/dependabot/1","created_at":"2025-01-27T04:39:24Z","updated_at":"2025-01-27T04:39:24Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null}]